<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 1: Introduction to Agricultural Soil Mechanics</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background: #fdfdfd;
        }
        h1, h2, h3 {
            color: #2b4a69;
        }
        .section {
            margin-bottom: 30px;
        }
        .formula {
            background: #f3f6fa;
            padding: 10px;
            border-left: 4px solid #2b4a69;
            margin: 10px 0;
            font-family: "Courier New", monospace;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        table, th, td {
            border: 1px solid #bbb;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background: #e4eaf2;
        }
        .variables {
            font-size: 0.95em;
            margin-left: 15px;
        }
        .variables p {
            margin: 2px 0;
        }
        .reference {
            font-size: 0.9em;
            color: #555;
        }
    </style>
</head>

<body>

<h1>Module 1: Introduction to Agricultural Soil Mechanics</h1>

<div class="section">
    <h2>1.1 Overview</h2>
    <p>
        Agricultural soil mechanics focuses on how soil responds to external loads from tillage tools, tractor wheels,
        and field traffic. Equations related to soil density, porosity, moisture, strength, and stress are fundamental 
        for predicting soil compaction in agricultural fields.
    </p>
</div>

<div class="section">
    <h2>1.2 Three-Phase Soil System</h2>
    <p>Soil consists of solid particles, water, and air. The total soil volume is expressed as:</p>
    [Image of 3 phase soil system]
    <div class="formula">$$V = V_{s} + V_{w} + V_{a}$$</div>
    <div class="variables">
        <p><strong>V</strong> = total soil volume</p>
        <p><strong>V<sub>s</sub></strong> = volume of soil solids</p>
        <p><strong>V<sub>w</sub></strong> = volume of water in pores</p>
        <p><strong>V<sub>a</sub></strong> = volume of air in pores</p>
    </div>
    <p class="reference">Reference: Hillel, D. (2004). <em>Introduction to Environmental Soil Physics</em>. Academic Press.</p>
</div>

<div class="section">
    <h2>1.3 Soil Mass–Volume Relationships</h2>

    <h3>1.3.1 Bulk Density ($\rho_{b}$)</h3>
    <div class="formula">$$\rho_{b} = M_{s} / V$$</div>
    <div class="variables">
        <p><strong>$\rho_{b}$</strong> = bulk density of soil (g/cm³)</p>
        <p><strong>$M_{s}$</strong> = mass of dry soil solids (g)</p>
        <p><strong>V</strong> = total soil volume (cm³)</p>
    </div>
    <p class="reference">Reference: Brady, N.C. & Weil, R.R. (2017). <em>The Nature and Properties of Soils</em>, 15th Edition. Pearson.</p>

    <h3>1.3.2 Particle Density ($\rho_{s}$)</h3>
    <div class="formula">$$\rho_{s} = M_{s} / V_{s}$$</div>
    <div class="variables">
        <p><strong>$\rho_{s}$</strong> = particle density of soil solids (g/cm³)</p>
        <p><strong>$M_{s}$</strong> = mass of dry soil solids (g)</p>
        <p><strong>$V_{s}$</strong> = volume of soil solids (cm³)</p>
    </div>
    <p class="reference">Reference: Hillel, D. (2004). <em>Introduction to Environmental Soil Physics</em>. Academic Press.</p>

    <h3>1.3.3 Porosity (n)</h3>
    <div class="formula">$$n = 1 − (\rho_{b} / \rho_{s})$$</div>
    <div class="variables">
        <p><strong>n</strong> = porosity (fraction of soil volume that is pore space)</p>
    </div>
    <p class="reference">Reference: Brady & Weil, 2017.</p>

    <h3>1.3.4 Void Ratio (e)</h3>
    <div class="formula">$$e = V_{v} / V_{s}$$</div>
    <div class="variables">
        <p><strong>e</strong> = void ratio</p>
        <p><strong>$V_{v}$</strong> = volume of voids ($V_{w}$ + $V_{a}$)</p>
    </div>
    <div class="formula">$$n = e / (1 + e)$$</div>
    <p class="reference">Reference: Lambe, T.W. & Whitman, R.V. (1969). <em>Soil Mechanics</em>. Wiley.</p>
</div>

<div class="section">
    <h2>1.4 Soil Moisture Content</h2>

    <h3>1.4.1 Wet-Basis Moisture Content ($MC_{wb}$)</h3>
    <div class="formula">$$MC_{wb} = (M_{w} / (M_{w} + M_{s})) \times 100\%$$</div>
    <div class="variables">
        <p><strong>$MC_{wb}$</strong> = moisture content on wet basis (%)</p>
        <p><strong>$M_{w}$</strong> = mass of water (g)</p>
        <p><strong>$M_{s}$</strong> = mass of dry soil solids (g)</p>
    </div>
    <p class="reference">Reference: Gee, G.W. & Or, D. (2002). <em>Particle-size analysis</em>. In: Dane, J.H., Topp, G.C. (eds) Methods of Soil Analysis.</p>

    <h3>1.4.2 Dry-Basis Moisture Content ($MC_{db}$)</h3>
    <div class="formula">$$MC_{db} = (M_{w} / M_{s}) \times 100\%$$</div>
    <div class="variables">
        <p><strong>$MC_{db}$</strong> = moisture content on dry basis (%)</p>
    </div>

    <h3>1.4.3 Volumetric Water Content ($\theta$)</h3>
    <div class="formula">$$\theta = V_{w} / V$$</div>
    <div class="variables">
        <p><strong>$\theta$</strong> = volumetric water content (fraction)</p>
    </div>
    <div class="formula">$$\theta = MC_{db} \times (\rho_{b} / \rho_{w})$$</div>
    <div class="variables">
        <p><strong>$\rho_{w}$</strong> = water density ($\approx 1$ g/cm³)</p>
    </div>
    <p class="reference">Reference: Hillel, 2004; Brady & Weil, 2017.</p>
</div>

<div class="section">
    <h2>1.5 Soil Stress Under Load</h2>

    <h3>Normal Stress ($\sigma$)</h3>
    <div class="formula">$$\sigma = F / A$$</div>
    <div class="variables">
        <p><strong>$\sigma$</strong> = normal stress on soil (Pa)</p>
        <p><strong>F</strong> = applied force (N)</p>
        <p><strong>A</strong> = contact area (m²)</p>
    </div>
    <p class="reference">Reference: Lambe & Whitman, 1969.</p>

    <h3>Vertical Stress (Boussinesq Equation)</h3>
    <div class="formula">$$\sigma_{z} = \frac{3P}{2\pi z^{2}} \times \left[\frac{1}{1 + (r/z)^{2}}^{5/2}\right]$$</div>
    <div class="variables">
        <p><strong>$\sigma_{z}$</strong> = vertical stress at depth z (Pa)</p>
        <p><strong>P</strong> = point load (N)</p>
        <p><strong>z</strong> = depth from surface (m)</p>
        <p><strong>r</strong> = radial distance from load center (m)</p>
    </div>
    <p class="reference">Reference: Boussinesq, J. (1885). <em>Application des Potentiels à l'étude de l'équilibre et du mouvement des solides élastiques</em>.</p>
</div>

<div class="section">
    <h2>1.6 Soil Strength</h2>

    <h3>Mohr–Coulomb Criterion</h3>
    <div class="formula">$$\tau = c + \sigma \tan \phi$$</div>
    <div class="variables">
        <p><strong>$\tau$</strong> = shear stress (Pa)</p>
        <p><strong>c</strong> = cohesion (Pa)</p>
        <p><strong>$\sigma$</strong> = normal stress (Pa)</p>
        <p><strong>$\phi$</strong> = internal friction angle (degrees)</p>
    </div>
    <p class="reference">Reference: Lambe & Whitman, 1969; Brady & Weil, 2017.</p>

    <h3>Cone Index (CI)</h3>
    <div class="formula">$$CI = F / A_{c}$$</div>
    <div class="variables">
        <p><strong>CI</strong> = penetration resistance (Pa)</p>
        <p><strong>F</strong> = force to push cone (N)</p>
        <p><strong>$A_{c}$</strong> = area of cone base (m²)</p>
    </div>
    <p class="reference">Reference: ASABE Standard, S313.3 (2017).</p>
</div>

<div class="section">
    <h2>1.7 Soil Bearing Capacity</h2>
    <div class="formula">
        $$q_{ult} = c N_{c} + \sigma' N_{q} + 0.5 \gamma B N_{\gamma}$$
    </div>
    <div class="variables">
        <p><strong>$q_{ult}$</strong> = ultimate bearing capacity (Pa)</p>
        <p><strong>$\sigma'$</strong> = effective overburden pressure (Pa)</p>
        <p><strong>B</strong> = width of loaded area (m)</p>
        <p><strong>$\gamma$</strong> = unit weight of soil (N/m³)</p>
        <p><strong>$N_{c}$, $N_{q}$, $N_{\gamma}$</strong> = bearing capacity factors</p>
    </div>
    <p class="reference">Reference: Terzaghi, K. (1943). <em>Theoretical Soil Mechanics</em>. Wiley.</p>
</div>

<div class="section">
    <h2>1.8 Compaction Index</h2>
    <div class="formula">
        $$CI_{x} = \frac{(\rho_{b,compacted} - \rho_{b,initial})}{\rho_{b,initial}} \times 100\%$$
    </div>
    <div class="variables">
        <p><strong>$CI_{x}$</strong> = compaction index (%)</p>
        <p><strong>$\rho_{b,compacted}$</strong> = bulk density after compaction (g/cm³)</p>
        <p><strong>$\rho_{b,initial}$</strong> = initial bulk density (g/cm³)</p>
    </div>
    <p class="reference">Reference: Hamza, M.A. & Anderson, W.K. (2005). <em>Soil compaction in cropping systems</em>. Soil & Tillage Research, 82: 121–145.</p>
</div>

<!-- SCRIPT BLOCK MOVED TO BEST PRACTICE LOCATION -->
<script>
    function sendHeight() {
        try {
            // ใช้ document.documentElement.scrollHeight เพื่อการวัดความสูงที่น่าเชื่อถือขึ้น
            // Note: We use Math.max to account for both documentElement and body height, although documentElement is usually sufficient.
            const height = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight);
            
            // เพิ่ม console.log เพื่อตรวจสอบว่าฟังก์ชันรันและส่งค่าความสูงเท่าไหร่
            console.log('sendHeight: Sending calculated height to parent:', height + 'px');
            
            // ส่งข้อความไปยัง Parent window เพื่อปรับขนาด iframe
            // NOTE: The '*' wildcard means the message can be sent to any domain.
            parent.postMessage({ height: height }, "*");

        } catch (error) {
            // ดักจับข้อผิดพลาดเผื่อกรณีที่โค้ดนี้ไม่ได้รันใน iframe (i.e., parent is undefined)
            console.error('sendHeight: Error executing or posting message (usually means no parent window or code is not in iframe):', error);
        }
    }
    
    // รันเมื่อโครงสร้าง DOM โหลดเสร็จ
    document.addEventListener('DOMContentLoaded', sendHeight); 
    
    // รันเมื่อโหลดเสร็จสมบูรณ์ (รวมถึงรูปภาพและสไตล์ทั้งหมด)
    window.addEventListener('load', sendHeight);
    
    // รันเมื่อขนาดหน้าจอถูกปรับ
    window.addEventListener('resize', sendHeight);
</script>

</body>
</html>
